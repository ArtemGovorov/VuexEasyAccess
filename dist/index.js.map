{"version":3,"file":"index.js","sources":["../src/objectDeepValueUtils.js","../src/storeAccess.js","../src/defaultConfig.js","../src/index.js"],"sourcesContent":["import { isArray } from 'is-what'\n\n/**\n * Returns the keys of a path\n *\n * @param   {string} path   a/path/like.this\n * @returns {array} with keys\n */\nfunction getKeysFromPath (path) {\n  if (!path) return []\n  return path.match(/\\w+/g)\n}\n\n/**\n * Gets a deep property in an object, based on a path to that property\n *\n * @param {object} target an object to wherefrom to retrieve the deep reference of\n * @param {string} path   'path/to.prop'\n *\n * @returns {object} the property which was requested\n */\nfunction getDeepRef (target = {}, path) {\n  let keys = getKeysFromPath(path)\n  if (!keys.length) return target\n  let obj = target\n  while (obj && keys.length > 1) {\n    obj = obj[keys.shift()]\n  }\n  let key = keys.shift()\n  if (obj && obj.hasOwnProperty(key)) {\n    return obj[key]\n  }\n}\n\n/**\n * Gets a deep property in an object, based on a path to that property\n *\n * @param   {object} target   the Object to get the value of\n * @param   {string} path     'path/to/prop.subprop'\n *\n * @returns {object}          the property's value\n */\nfunction getDeepValue (target, path) {\n  return getDeepRef(target, path)\n}\n\n/**\n * Sets a value to a deep property in an object, based on a path to that property\n *\n * @param   {object} target   the Object to set the value on\n * @param   {string} path     'path/to/prop.subprop'\n * @param   {*}      value    the value to set\n *\n * @returns {object}          the original target object\n */\nfunction setDeepValue (target, path, value) {\n  const keys = getKeysFromPath(path)\n  const lastKey = keys.pop()\n  const deepRef = getDeepRef(target, keys.join())\n  if (deepRef && deepRef.hasOwnProperty(lastKey)) {\n    deepRef[lastKey] = value\n  }\n  return target\n}\n\n/**\n * Pops a value of an array which is a deep property in an object, based on a path to that property\n *\n * @param   {object} target   the Object to set the value on\n * @param   {string} path     'path.to.sub.prop'\n *\n * @returns {*}               the popped value\n */\nfunction popDeepValue (target, path) {\n  const deepRef = getDeepRef(target, path)\n  if (!isArray(deepRef)) return\n  return deepRef.pop()\n}\n/**\n * Pushes a value in an array which is a deep property in an object, based on a path to that property\n *\n * @param   {object} target   the Object to set the value on\n * @param   {string} path     'path/to.sub.prop'\n * @param   {*}      value    the value to set\n *\n * @returns {number}          the new length of the array\n */\nfunction pushDeepValue (target, path, value) {\n  const deepRef = getDeepRef(target, path)\n  if (!isArray(deepRef)) return\n  return deepRef.push(value)\n}\n/**\n * Splice into an array which is a deep property in an object, based on a path to that property\n *\n * @param   {object} target       the Object to set the value on\n * @param   {string} path         'path/to.sub.prop'\n * @param   {*}      value        the value to splice in\n * @param   {number} index        the index to splice in the value, defaults to 0\n * @param   {number} deleteCount  the amount of items to delete, defaults to 0\n *\n * @returns {array}              an array containing the deleted elements\n */\nfunction spliceDeepValue (target, path, index = 0, deleteCount = 0, value) {\n  const deepRef = getDeepRef(target, path)\n  if (!isArray(deepRef)) return\n  return deepRef.splice(index, deleteCount, value)\n}\n\nexport { getDeepRef, getKeysFromPath, setDeepValue, getDeepValue, popDeepValue, pushDeepValue, spliceDeepValue }\n","/**\n * Vuex Easy Access plugin\n * Unified syntax with simple set() and get() store access + auto generate mutations!\n *\n * @author     Luca Ban\n * @contact    https://lucaban.com\n */\n\nimport { setDeepValue, getDeepValue, popDeepValue, pushDeepValue, spliceDeepValue } from './objectDeepValueUtils'\nimport { isObject, isArray } from 'is-what'\n\n/**\n * Creates the mutations for each property of the object passed recursively\n *\n * @param   {object} propParent an Object of which all props will get a mutation\n * @param   {string} path       the path taken until the current propParent instance\n *\n * @returns {object}            all mutations for each property.\n */\nfunction makeMutationsForAllProps(propParent, path) {\n  if (!isObject(propParent)) return {}\n  return Object.keys(propParent)\n  .reduce((mutations, prop) => {\n    let propPath = (!path)\n      ? prop\n      : path + '.' + prop\n    let name = 'SET_' + propPath.toUpperCase()\n    mutations[name] = (state, newVal) => {\n      return setDeepValue(state, propPath, newVal)\n    }\n    let propValue = propParent[prop]\n    // If the prop is an object, make the children setters as well\n    if (isObject(propValue)) {\n      let childrenMutations = makeMutationsForAllProps(propValue, propPath)\n      mutations = {...mutations, ...childrenMutations}\n    }\n    // If the prop is an array, make array mutations as well\n    if (isArray(propValue)) {\n      let pop = 'POP_' + propPath.toUpperCase()\n      mutations[pop] = (state) => {\n        return popDeepValue(state, propPath)\n      }\n      let push = 'PUSH_' + propPath.toUpperCase()\n      mutations[push] = (state, value) => {\n        return pushDeepValue(state, propPath, value)\n      }\n      let splice = 'SPLICE_' + propPath.toUpperCase()\n      mutations[splice] = (state, index, deleteCount, value) => {\n        return spliceDeepValue(state, propPath, index, deleteCount, value)\n      }\n    }\n    return mutations\n  }, {})\n}\n\n/**\n * Creates all mutations for the state of a module.\n * Usage:\n * commit('module/path/SET_PATH.TO.PROP', newValue)\n * Import method:\n * mutations {\n *   ...defaultMutations (initialState)\n * }\n *\n * @param   {object} initialState   the initial state of a module\n *\n * @returns {object}                all mutations for the state\n */\nfunction defaultMutations (initialState) {\n  return makeMutationsForAllProps(initialState)\n}\n\n/**\n * Creates a setter function in the store to set any state value\n * Usage:\n * `set('module/path/path.to.prop', newValue)`\n * it will check first for existence of: `dispatch('module/path/setPath.to.prop')`\n * if non existant it will execute: `commit('module/path/SET_PATH.TO.PROP', newValue)`\n * Import method:\n * `store.set = (path, payload) => { return defaultSetter(path, payload, store) }`\n *\n * @param   {string}   path     the path of the prop to set eg. 'info/user/favColours.primary'\n * @param   {*}        payload  the payload to set the prop to\n * @param   {object}   store    the store to attach\n *\n * @returns {function}          dispatch or commit\n */\nfunction defaultSetter (path, payload, store, vuexEasyFirestore) {\n  // path = 'info/user/favColours.primary'\n  const pArr = path.split('/')\n  // ['info', 'user', 'favColours.primary']\n  const props = pArr.pop()\n  // 'favColours.primary'\n  const modulePath = (pArr.length)\n    ? pArr.join('/') + '/'\n    : ''\n  // 'info/user/'\n  const actionName = 'set' + props[0].toUpperCase() + props.substring(1)\n  // 'setFavColours.primary'\n  const actionPath = modulePath + actionName\n  // 'info/user/setFavColours.primary'\n  const actionExists = store._actions[actionPath]\n  if (actionExists) {\n    return store.dispatch(actionPath, payload)\n  }\n  if (vuexEasyFirestore) {\n    // 'info/user/set', {favColours: {primary: payload}}'\n    const pathIsModule = store._modulesNamespaceMap[path + '/']\n    const firestoreActionPath = (pathIsModule)\n      ? path + '/set'\n      : modulePath + 'set'\n    const newPayload = (pathIsModule)\n      ? payload\n      : {}\n    if (!pathIsModule) newPayload[props] = payload\n    const firestoreActionExists = store._actions[firestoreActionPath]\n    if (firestoreActionExists) {\n      return store.dispatch(firestoreActionPath, newPayload)\n    }\n  }\n  const mutationPath = modulePath + 'SET_' + props.toUpperCase()\n  return store.commit(mutationPath, payload)\n}\n\n/**\n * Creates a getter function in the store to set any state value\n * Usage:\n * `get('module/path/path.to.prop')`\n * it will check first for existence of: `getters['module/path/path.to.prop']`\n * if non existant it will return: `state.module.path.path.to.prop`\n * Import method:\n * `store.get = (path) => { return defaultGetter(path, store) }`\n *\n * @param   {string}   path     the path of the prop to get eg. 'info/user/favColours.primary'\n * @param   {object}   store    the store to attach\n *\n * @returns {function}          getter or state\n */\nfunction defaultGetter (path, store) {\n  const getterExists = store.getters.hasOwnProperty(path)\n  if (getterExists) return store.getters[path]\n  return getDeepValue(store.state, path)\n}\n\nexport { defaultMutations, defaultSetter, defaultGetter }\n","\nexport default {\n  setter: 'set',\n  getter: 'get',\n  vuexEasyFirestore: false\n}\n","/**\n * Vuex Easy Access plugin\n * Unified syntax with simple set() and get() store access + auto generate mutations!\n *\n * @author     Luca Ban\n * @contact    https://lucaban.com\n */\n\nimport { defaultMutations, defaultSetter, defaultGetter } from './storeAccess'\nimport defaultConfig from './defaultConfig'\nimport { getDeepRef, getKeysFromPath } from './objectDeepValueUtils'\n\nfunction createEasyAccess (userConfig) {\n  const conf = Object.assign(defaultConfig, userConfig)\n  const vuexEasyFirestore = conf.vuexEasyFirestore\n  return store => {\n    store[conf.setter] = (path, payload) => { return defaultSetter(path, payload, store, vuexEasyFirestore) }\n    store[conf.getter] = (path) => { return defaultGetter(path, store) }\n  }\n}\n\nexport default createEasyAccess\nexport { createEasyAccess, defaultMutations, defaultSetter, defaultGetter, getDeepRef, getKeysFromPath }\n"],"names":["getKeysFromPath","path","match","getDeepRef","target","keys","length","obj","shift","key","hasOwnProperty","getDeepValue","setDeepValue","value","lastKey","pop","deepRef","join","popDeepValue","isArray","pushDeepValue","push","spliceDeepValue","index","deleteCount","splice","makeMutationsForAllProps","propParent","isObject","Object","reduce","mutations","prop","propPath","name","toUpperCase","state","newVal","propValue","childrenMutations","defaultMutations","initialState","defaultSetter","payload","store","vuexEasyFirestore","pArr","split","props","modulePath","actionName","substring","actionPath","actionExists","_actions","dispatch","pathIsModule","_modulesNamespaceMap","firestoreActionPath","newPayload","firestoreActionExists","mutationPath","commit","defaultGetter","getterExists","getters","setter","getter","createEasyAccess","userConfig","conf","assign","defaultConfig"],"mappings":"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"}